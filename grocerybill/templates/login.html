<!DOCTYPE html>
<html>
    <head>
        <title>User Login</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <style>
            body {
                margin: 0;
                min-height: 100vh;
                font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
                background: linear-gradient(120deg, #e6f6fb 0%, #b9e7ff 100%);
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .login-card {
                background: rgba(255,255,255,0.96);
                border-radius: 18px;
                box-shadow: 0 8px 28px rgba(38,137,186,0.1);
                padding: 48px 32px 38px 32px;
                text-align: center;
                max-width: 350px;
                width: 100%;
                animation: floatIn 1.1s cubic-bezier(.31,.57,.54,.99);
            }
            @keyframes floatIn {
                from { transform: translateY(26px) scale(0.95); opacity: 0; }
                to { transform: translateY(0) scale(1); opacity: 1; }
            }
            .login-card h2 {
                color: #1a7bbd;
                font-size: 2em;
                margin-bottom: 16px;
                letter-spacing: 0.6px;
            }
            .anim {
                width: 72px;
                margin: 0 auto 24px auto;
                animation: floatIcon 2.4s infinite alternate ease-in-out;
                display: block;
            }
            @keyframes floatIcon {
                from { transform: translateY(0);}
                to { transform: translateY(-20px);}
            }
            .input-field {
                margin-bottom: 20px;
                width: 90%;
            }
            input[type="text"], input[type="password"] {
                width: 100%;
                padding: 10px 13px;
                margin-top: 6px;
                border: 1.5px solid #c5d7e2;
                border-radius: 7px;
                font-size: 1em;
                background: #f7fbff;
                color: #114a71;
                transition: border-color 0.2s, box-shadow 0.2s;
                box-shadow: 0 1.5px 0 #e3f0ff;
            }
            input[type="text"]:focus, input[type="password"]:focus {
                outline: none;
                border-color: #1976d2;
                box-shadow: 0 0 0 3px #a5cdfc;
            }
            button {
                width: 100%;
                background: linear-gradient(92deg, #1a73e8 0%, #155cbf 100%);
                color: white;
                font-weight: 600;
                border: none;
                border-radius: 7px;
                font-size: 1.13em;
                padding: 12px 0 12px 0;
                margin-top: 13px;
                box-shadow: 0 4px 22px rgba(26,83,163,0.3);
                cursor: pointer;
                transition: background 0.2s, transform 0.1s;
                letter-spacing: 0.3px;
            }
            button:hover {
                background: linear-gradient(92deg, #145eba 0%, #123e75 100%);
                transform: scale(1.04);
            }
            .back-link {
                font-size: 0.95em;
                color: #145eba;
                text-decoration: none;
                margin-top: 9px;
                display: inline-block;
                transition: text-decoration 0.2s;
            }
            .back-link:hover { text-decoration: underline; }
            #message {
                margin-top: 14px;
                font-size: 1em;
                font-weight: 600;
                min-height: 24px;
                color: #d32f2f;
                transition: all 0.3s ease;
            }
            @media (max-width: 580px) {
                .login-card { padding: 28px 5vw 24px 5vw;}
                .login-card h2 { font-size: 1.4em;}
            }
        </style>
    </head>
    <body>
        <div class="login-card">
            <svg class="anim" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="40" cy="40" r="38" fill="#a5d0ff" fill-opacity="0.35" />
                <rect x="26" y="38" width="28" height="8" rx="4" fill="#1a73e8"/>
                <circle cx="28" cy="36" r="6" fill="#1976d2" />
                <rect x="38" y="30" width="10" height="30" rx="3" fill="#144e9a" />
                <circle cx="52" cy="40" r="6" fill="#366abe" />
            </svg>

            <h2>User Login</h2>
            <form id="loginForm">
                <div class="input-field">
                    <input id="username" name="username" type="text" placeholder="Username" required/>
                </div>
                <div class="input-field">
                    <input id="password" name="password" type="password" placeholder="Password" required/>
                </div>
                <button type="submit">Login</button>
                <div id="message"></div>
            </form>
            <a href="/" class="back-link">&#8592; Back to Home</a>
        </div>

        <script>
            const loginForm = document.getElementById("loginForm");
            const messageDiv = document.getElementById("message");

            loginForm.addEventListener("submit", async (e) => {
                e.preventDefault();
                messageDiv.style.color = "#000";
                messageDiv.textContent = "Checking credentials...";

                const formData = new URLSearchParams();
                formData.append("username", loginForm.username.value);
                formData.append("password", loginForm.password.value);

                try {
                    const response = await fetch("/login", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: formData.toString()
                    });
                    const result = await response.json();

                    if (response.ok && result.access_token) {
                        // SAVE TOKEN!
                        localStorage.setItem("access_token", result.access_token);
                        messageDiv.style.color = "#2e7d32";
                        messageDiv.textContent = "Login successful! Redirecting...";
                        setTimeout(() => window.location.href = "/profile", 1000);
                    } else {
                        messageDiv.style.color = "#d32f2f";
                        messageDiv.textContent = result.detail || "Invalid username or password.";
                    }
                } catch (error) {
                    messageDiv.style.color = "#d32f2f";
                    messageDiv.textContent = "Unexpected error. Please try again.";
                }
            });
        </script>
    </body>
    </html>